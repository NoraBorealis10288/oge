@page "/dooractivity"
@rendermode InteractiveServer

<PageTitle>Info Page</PageTitle>

<p class="title"><b>Most Accessed Doors</b></p>
<hr>

<div class="content">
    @if (Shared.uploadStatus.Equals("file")) {
        Sort();
        
        <h4>Top @numDoors Most Active Doors</h4>

        <table>
            <thead>
                <th>Door</th>
                <th>Accesses</th>
            </thead>
            <tbody>
                @for (int i=1;i<=numDoors;i++) {
                    <tr>
                        <td>@Shared.dict[data[data.Count-i].Item1][0].GetDesc().Substring(22)</td>
                        <td>@data[data.Count-i].Item2</td>
                        
                    </tr>
                }
            </tbody>
        </table>
    }
</div>

<style>

hr {
    border-top: 5px solid #000;
    opacity: 1;
    width: 80%;
    margin: auto;
}

.title {
    font-size: 70px;
    font-family: 'Courier New', monospace;
}

.content {
    text-align: center;
}

table, th, td {
  border: 1px solid black;
}

table {
    width: 50%;
    margin: auto;
}

th {
    background-color: #6b6c70;
    color: #ffffff;
}

</style>

@code {
    List<(int id,int numAccesses)> data = new List<(int id,int numAccesses)>();
    int numDoors {get; set;} = 10;
    public void Sort() {
        foreach (KeyValuePair<int,List<ReaderEvent>> kvp in Shared.dict) {
            data.Add((kvp.Key,kvp.Value.Count));
        }

        (int id,int numAccesses) temp;
        for (int j=0; j<=data.Count-2; j++)
        {
            for (int i=0; i<=data.Count-2; i++)
            {
                if (data[i].numAccesses > data[i+1].numAccesses)
                {
                    temp = (data[i+1].id,data[i+1].numAccesses);
                    data[i+1] = (data[i].id,data[i].numAccesses);
                    data[i] = (temp.id,temp.numAccesses);
                }
            }
        }
    }
}